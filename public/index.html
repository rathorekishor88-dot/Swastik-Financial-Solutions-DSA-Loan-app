<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swastik Financial Solutions - DSA Portal</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Login Section -->
    <div id="loginSection" class="login-container">
        <div class="login-box">
            <div class="login-header">
                <h2>Swastik Financial Solutions</h2>
                <p>DSA Portal - Login</p>
            </div>
            
            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" required>
                </div>
                
                <button type="submit" class="btn-primary">Login</button>
                
                <div class="login-links">
                    <a href="#" id="forgotPasswordLink">Forgot Password?</a>
                </div>
            </form>

            <!-- Forgot Password Form -->
            <form id="forgotPasswordForm" class="login-form hidden">
                <div class="form-group">
                    <label for="forgotEmail">Email</label>
                    <input type="email" id="forgotEmail" name="email" required>
                </div>
                <button type="submit" class="btn-primary">Send OTP</button>
                <div class="login-links">
                    <a href="#" id="backToLogin">Back to Login</a>
                </div>
            </form>

            <!-- Reset Password Form -->
            <form id="resetPasswordForm" class="login-form hidden">
                <input type="hidden" id="resetEmail">
                <div class="form-group">
                    <label for="otp">OTP</label>
                    <input type="text" id="otp" name="otp" required maxlength="6">
                </div>
                <div class="form-group">
                    <label for="newPassword">New Password</label>
                    <input type="password" id="newPassword" name="newPassword" required>
                    <small>Password must contain at least 8 characters with uppercase, lowercase, number, and special character</small>
                </div>
                <div class="form-group">
                    <label for="confirmPassword">Confirm Password</label>
                    <input type="password" id="confirmPassword" name="confirmPassword" required>
                </div>
                <button type="submit" class="btn-primary">Reset Password</button>
                <div class="login-links">
                    <a href="#" id="backToLogin2">Back to Login</a>
                </div>
            </form>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="hidden">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1>Swastik Financial Solutions - DSA Portal</h1>
                <div class="user-info">
                    <span>Welcome, <span id="userName">User</span> (<span id="userRole">Role</span>)</span>
                    <button id="logoutBtn" class="btn-logout">Logout</button>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="navbar">
            <div class="nav-content">
                <button id="dashboardBtn" class="nav-btn active">Dashboard</button>
                <button id="vehicleBtn" class="nav-btn">Vehicle Loans</button>
                <button id="msmeBtn" class="nav-btn">MSME Loans</button>
                <button id="plBtn" class="nav-btn">Personal Loans</button>
                <button id="payoutBtn" class="nav-btn">Payouts</button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboardSection" class="content-section">
                <div class="section-header">
                    <h2>Dashboard Overview</h2>
                    <div class="dashboard-controls">
                        <button class="btn-secondary" onclick="refreshDashboard()">Refresh</button>
                    </div>
                </div>
                
                <!-- Summary Cards -->
                <div class="summary-cards">
                    <div class="summary-card">
                        <h3>Total Cases</h3>
                        <div class="number" id="totalCases">0</div>
                        <div class="trend" id="totalCasesTrend"></div>
                    </div>
                    <div class="summary-card">
                        <h3>Total Amount</h3>
                        <div class="number" id="totalAmount">₹0</div>
                        <div class="trend" id="totalAmountTrend"></div>
                    </div>
                    <div class="summary-card">
                        <h3>Disbursed Cases</h3>
                        <div class="number" id="disbursedCases">0</div>
                        <div class="trend" id="disbursedCasesTrend"></div>
                    </div>
                    <div class="summary-card">
                        <h3>Pending Cases</h3>
                        <div class="number" id="pendingCases">0</div>
                        <div class="trend" id="pendingCasesTrend"></div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <h3>Quick Actions</h3>
                    <div class="action-buttons">
                        <button class="btn-primary" onclick="showSection('vehicleSection')">Add Vehicle Case</button>
                        <button class="btn-primary" onclick="showSection('msmeSection')">Add MSME Case</button>
                        <button class="btn-primary" onclick="showSection('plSection')">Add PL Case</button>
                        <button class="btn-secondary" onclick="exportAllData()">Export All Data</button>
                    </div>
                </div>
            </section>

            <!-- Vehicle Loans Section -->
            <section id="vehicleSection" class="content-section hidden">
                <div class="section-header">
                    <h2 id="vehicleFormTitle">Add Vehicle Loan Case</h2>
                    <div class="section-actions">
                        <button class="btn-secondary" onclick="exportData('vehicle')">Export Data</button>
                        <button class="btn-info" onclick="clearVehicleForm()">Clear Form</button>
                    </div>
                </div>

                <!-- Vehicle Loan Form -->
                <form id="vehicleForm" class="loan-form">
                    <div class="form-grid">
                        <!-- Basic Information -->
                        <div class="form-section">
                            <h3>Basic Information</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="vehicleDate">Date</label>
                                    <input type="date" id="vehicleDate" name="date" required>
                                </div>
                                <div class="form-group">
                                    <label for="vehicleMonth">Month</label>
                                    <input type="text" id="vehicleMonth" name="month" required readonly>
                                </div>
                                <div class="form-group">
                                    <label for="vehicleProduct">Product</label>
                                    <select id="vehicleProduct" name="product" required>
                                        <option value="">Select Product</option>
                                        <option value="Car Loan">Car Loan</option>
                                        <option value="Bike Loan">Bike Loan</option>
                                        <option value="Commercial Vehicle">Commercial Vehicle</option>
                                        <option value="Tractor Loan">Tractor Loan</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="vehicleCaseBookAt">Case Book At</label>
                                    <input type="text" id="vehicleCaseBookAt" name="case_book_at" required>
                                </div>
                                <div class="form-group">
                                    <label for="vehicleCustomerName">Customer Name</label>
                                    <input type="text" id="vehicleCustomerName" name="customer_name" required>
                                </div>
                                <div class="form-group">
                                    <label for="vehicleMobile">Mobile</label>
                                    <input type="tel" id="vehicleMobile" name="mobile" required maxlength="10" pattern="[6-9][0-9]{9}" title="10-digit mobile number starting with 6-9">
                                </div>
                            </div>

                            <div class="form-group full-width">
                                <label for="vehicleAddress">Address</label>
                                <textarea id="vehicleAddress" name="address" rows="2" required></textarea>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="vehicleApplicantOccupation">Applicant Occupation</label>
                                    <input type="text" id="vehicleApplicantOccupation" name="applicant_occupation" required>
                                </div>
                                <div class="form-group">
                                    <label for="vehicleEndUsed">Vehicle End Used</label>
                                    <input type="text" id="vehicleEndUsed" name="vehicle_end_used" required>
                                </div>
                            </div>
                        </div>

                        <!-- Vehicle Details -->
                        <div class="form-section">
                            <h3>Vehicle Details</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="vehicleNo">Vehicle No</label>
                                    <input type="text" id="vehicleNo" name="vehicle_no" required>
                                </div>
                                <div class="form-group">
                                    <label for="vehicleModelYear">Model Year</label>
                                    <input type="text" id="vehicleModelYear" name="model_year" required>
                                </div>
                                <div class="form-group">
                                    <label for="vehicleModel">Vehicle Model</label>
                                    <input type="text" id="vehicleModel" name="vehicle_model" required>
                                </div>
                            </div>
                        </div>

                        <!-- Financial Details -->
                        <div class="form-section">
                            <h3>Financial Details</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="vehicleIrr">IRR (%)</label>
                                    <input type="number" step="0.01" id="vehicleIrr" name="irr" required min="0" max="50">
                                </div>
                                <div class="form-group">
                                    <label for="vehicleFinanceAmount">Finance Amount (₹)</label>
                                    <input type="number" step="0.01" id="vehicleFinanceAmount" name="finance_amount" required min="0">
                                </div>
                                <div class="form-group">
                                    <label for="vehicleStatus">Status</label>
                                    <select id="vehicleStatus" name="status" required>
                                        <option value="">Select Status</option>
                                        <option value="Applied">Applied</option>
                                        <option value="Approved">Approved</option>
                                        <option value="Disbursed">Disbursed</option>
                                        <option value="Rejected">Rejected</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="vehicleDisbursementDate">Disbursement Date</label>
                                    <input type="date" id="vehicleDisbursementDate" name="disbursement_date">
                                </div>
                                <div class="form-group">
                                    <label for="vehicleSourcing">Sourcing</label>
                                    <input type="text" id="vehicleSourcing" name="sourcing" required>
                                </div>
                                <div class="form-group">
                                    <label for="vehicleSourcingBy">Sourcing By</label>
                                    <input type="text" id="vehicleSourcingBy" name="sourcing_by" required>
                                </div>
                            </div>
                        </div>

                        <!-- Co-applicants -->
                        <div class="form-section">
                            <h3>Co-applicants</h3>
                            <div id="vehicleCoApplicants"></div>
                            <button type="button" class="btn-secondary" onclick="addNewCoApplicant('vehicle')">
                                Add Co-applicant
                            </button>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Save Vehicle Case</button>
                        <button type="reset" class="btn-secondary">Reset Form</button>
                        <button type="button" class="btn-danger" onclick="cancelEdit()" id="cancelEditBtn" style="display: none;">Cancel Edit</button>
                    </div>
                </form>

                <!-- Vehicle Cases Table -->
                <div class="table-container">
                    <div class="table-header">
                        <h3>Vehicle Loan Cases</h3>
                        <div class="table-actions">
                            <input type="text" id="vehicleSearch" placeholder="Search cases..." onkeyup="searchVehicleCases()">
                            <button class="btn-secondary" onclick="loadVehicleData()">Refresh</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Customer Name</th>
                                <th>Mobile</th>
                                <th>Vehicle No</th>
                                <th>Finance Amount</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="vehicleTableBody">
                            <!-- Data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- MSME Loans Section -->
            <section id="msmeSection" class="content-section hidden">
                <div class="section-header">
                    <h2 id="msmeFormTitle">Add MSME Loan Case</h2>
                    <div class="section-actions">
                        <button class="btn-secondary" onclick="exportData('msme')">Export Data</button>
                        <button class="btn-info" onclick="clearMsmeForm()">Clear Form</button>
                    </div>
                </div>

                <!-- MSME Loan Form -->
                <form id="msmeForm" class="loan-form">
                    <div class="form-grid">
                        <!-- Basic Information -->
                        <div class="form-section">
                            <h3>Basic Information</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="msmeDate">Date</label>
                                    <input type="date" id="msmeDate" name="date" required>
                                </div>
                                <div class="form-group">
                                    <label for="msmeMonth">Month</label>
                                    <input type="text" id="msmeMonth" name="month" required readonly>
                                </div>
                                <div class="form-group">
                                    <label for="msmeProduct">Product</label>
                                    <select id="msmeProduct" name="product" required>
                                        <option value="">Select Product</option>
                                        <option value="Business Loan">Business Loan</option>
                                        <option value="Working Capital">Working Capital</option>
                                        <option value="Equipment Finance">Equipment Finance</option>
                                        <option value="MSME Loan">MSME Loan</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="msmeCaseBookAt">Case Book At</label>
                                    <input type="text" id="msmeCaseBookAt" name="case_book_at" required>
                                </div>
                                <div class="form-group">
                                    <label for="msmeCustomerName">Customer Name</label>
                                    <input type="text" id="msmeCustomerName" name="customer_name" required>
                                </div>
                                <div class="form-group">
                                    <label for="msmeMobile">Mobile</label>
                                    <input type="tel" id="msmeMobile" name="mobile" required maxlength="10" pattern="[6-9][0-9]{9}" title="10-digit mobile number starting with 6-9">
                                </div>
                            </div>

                            <div class="form-group full-width">
                                <label for="msmeAddress">Address</label>
                                <textarea id="msmeAddress" name="address" rows="2" required></textarea>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="msmeApplicantOccupation">Applicant Occupation</label>
                                    <input type="text" id="msmeApplicantOccupation" name="applicant_occupation" required>
                                </div>
                                <div class="form-group">
                                    <label for="msmeEndUsed">Loan End Used</label>
                                    <input type="text" id="msmeEndUsed" name="loan_end_used" required>
                                </div>
                                <div class="form-group">
                                    <label for="msmePropertyType">Property Type</label>
                                    <input type="text" id="msmePropertyType" name="property_type" required>
                                </div>
                            </div>
                        </div>

                        <!-- Financial Details -->
                        <div class="form-section">
                            <h3>Financial Details</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="msmeIrr">IRR (%)</label>
                                    <input type="number" step="0.01" id="msmeIrr" name="irr" required min="0" max="50">
                                </div>
                                <div class="form-group">
                                    <label for="msmeFinanceAmount">Finance Amount (₹)</label>
                                    <input type="number" step="0.01" id="msmeFinanceAmount" name="finance_amount" required min="0">
                                </div>
                                <div class="form-group">
                                    <label for="msmeStatus">Status</label>
                                    <select id="msmeStatus" name="status" required>
                                        <option value="">Select Status</option>
                                        <option value="Applied">Applied</option>
                                        <option value="Approved">Approved</option>
                                        <option value="Disbursed">Disbursed</option>
                                        <option value="Rejected">Rejected</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="msmeDisbursementDate">Disbursement Date</label>
                                    <input type="date" id="msmeDisbursementDate" name="disbursement_date">
                                </div>
                                <div class="form-group">
                                    <label for="msmeSourcing">Sourcing</label>
                                    <input type="text" id="msmeSourcing" name="sourcing" required>
                                </div>
                                <div class="form-group">
                                    <label for="msmeSourcingBy">Sourcing By</label>
                                    <input type="text" id="msmeSourcingBy" name="sourcing_by" required>
                                </div>
                            </div>
                        </div>

                        <!-- Co-applicants -->
                        <div class="form-section">
                            <h3>Co-applicants</h3>
                            <div id="msmeCoApplicants"></div>
                            <button type="button" class="btn-secondary" onclick="addNewCoApplicant('msme')">
                                Add Co-applicant
                            </button>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Save MSME Case</button>
                        <button type="reset" class="btn-secondary">Reset Form</button>
                        <button type="button" class="btn-danger" onclick="cancelEdit()" id="cancelEditBtnMsme" style="display: none;">Cancel Edit</button>
                    </div>
                </form>

                <!-- MSME Cases Table -->
                <div class="table-container">
                    <div class="table-header">
                        <h3>MSME Loan Cases</h3>
                        <div class="table-actions">
                            <input type="text" id="msmeSearch" placeholder="Search cases..." onkeyup="searchMsmeCases()">
                            <button class="btn-secondary" onclick="loadMsmeData()">Refresh</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Customer Name</th>
                                <th>Mobile</th>
                                <th>Property Type</th>
                                <th>Finance Amount</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="msmeTableBody">
                            <!-- Data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Personal Loans Section -->
            <section id="plSection" class="content-section hidden">
                <div class="section-header">
                    <h2 id="plFormTitle">Add Personal Loan Case</h2>
                    <div class="section-actions">
                        <button class="btn-secondary" onclick="exportData('pl')">Export Data</button>
                        <button class="btn-info" onclick="clearPlForm()">Clear Form</button>
                    </div>
                </div>

                <!-- Personal Loan Form -->
                <form id="plForm" class="loan-form">
                    <div class="form-grid">
                        <!-- Basic Information -->
                        <div class="form-section">
                            <h3>Basic Information</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="plDate">Date</label>
                                    <input type="date" id="plDate" name="date" required>
                                </div>
                                <div class="form-group">
                                    <label for="plMonth">Month</label>
                                    <input type="text" id="plMonth" name="month" required readonly>
                                </div>
                                <div class="form-group">
                                    <label for="plCaseBookAt">Case Book At</label>
                                    <input type="text" id="plCaseBookAt" name="case_book_at" required>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="plCustomerName">Customer Name</label>
                                    <input type="text" id="plCustomerName" name="customer_name" required>
                                </div>
                                <div class="form-group">
                                    <label for="plContactNo">Contact No</label>
                                    <input type="tel" id="plContactNo" name="contact_no" required maxlength="10" pattern="[6-9][0-9]{9}" title="10-digit mobile number starting with 6-9">
                                </div>
                            </div>

                            <div class="form-group full-width">
                                <label for="plAddress">Address</label>
                                <textarea id="plAddress" name="address" rows="2" required></textarea>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="plApplicantOccupation">Applicant Occupation</label>
                                    <input type="text" id="plApplicantOccupation" name="applicant_occupation" required>
                                </div>
                                <div class="form-group">
                                    <label for="plEndUsed">Loan End Used</label>
                                    <input type="text" id="plEndUsed" name="loan_end_used" required>
                                </div>
                            </div>
                        </div>

                        <!-- Financial Details -->
                        <div class="form-section">
                            <h3>Financial Details</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="plRoi">ROI (%)</label>
                                    <input type="number" step="0.01" id="plRoi" name="roi" required min="0" max="50">
                                </div>
                                <div class="form-group">
                                    <label for="plLoanAmount">Loan Amount (₹)</label>
                                    <input type="number" step="0.01" id="plLoanAmount" name="loan_amount" required min="0">
                                </div>
                                <div class="form-group">
                                    <label for="plStatus">Status</label>
                                    <select id="plStatus" name="status" required>
                                        <option value="">Select Status</option>
                                        <option value="Applied">Applied</option>
                                        <option value="Approved">Approved</option>
                                        <option value="Disbursed">Disbursed</option>
                                        <option value="Rejected">Rejected</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="plDisbursedDate">Disbursed Date</label>
                                    <input type="date" id="plDisbursedDate" name="disbursed_date">
                                </div>
                                <div class="form-group">
                                    <label for="plSourcing">Sourcing</label>
                                    <input type="text" id="plSourcing" name="sourcing" required>
                                </div>
                                <div class="form-group">
                                    <label for="plSourcingBy">Sourcing By</label>
                                    <input type="text" id="plSourcingBy" name="sourcing_by" required>
                                </div>
                            </div>
                        </div>

                        <!-- Co-applicants -->
                        <div class="form-section">
                            <h3>Co-applicants</h3>
                            <div id="plCoApplicants"></div>
                            <button type="button" class="btn-secondary" onclick="addNewCoApplicant('pl')">
                                Add Co-applicant
                            </button>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Save PL Case</button>
                        <button type="reset" class="btn-secondary">Reset Form</button>
                        <button type="button" class="btn-danger" onclick="cancelEdit()" id="cancelEditBtnPl" style="display: none;">Cancel Edit</button>
                    </div>
                </form>

                <!-- PL Cases Table -->
                <div class="table-container">
                    <div class="table-header">
                        <h3>Personal Loan Cases</h3>
                        <div class="table-actions">
                            <input type="text" id="plSearch" placeholder="Search cases..." onkeyup="searchPlCases()">
                            <button class="btn-secondary" onclick="loadPlData()">Refresh</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Customer Name</th>
                                <th>Contact No</th>
                                <th>Loan Amount</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="plTableBody">
                            <!-- Data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Payouts Section -->
            <section id="payoutSection" class="content-section hidden">
                <div class="section-header">
                    <h2>Payouts Management</h2>
                    <div class="section-actions">
                        <button class="btn-secondary" onclick="exportData('payout')">Export Data</button>
                    </div>
                </div>

                <!-- Payouts Table -->
                <div class="table-container">
                    <div class="table-header">
                        <h3>Payouts History</h3>
                        <div class="table-actions">
                            <input type="text" id="payoutSearch" placeholder="Search payouts..." onkeyup="searchPayouts()">
                            <button class="btn-secondary" onclick="loadPayoutData()">Refresh</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Payout Date</th>
                                <th>Customer Name</th>
                                <th>Product</th>
                                <th>Finance Amount</th>
                                <th>Payout Amount</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="payoutTableBody">
                            <!-- Data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <script src="script.js"></script>
</body>
</html>
